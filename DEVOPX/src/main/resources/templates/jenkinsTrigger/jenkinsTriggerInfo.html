<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>jenkinsTrigger</title>
    <meta name="msapplication-tap-highlight" content="no">
    <link rel="stylesheet" type="text/css" th:href="@{/devopx/thirdparty/system/main.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/devopx/thirdparty/system/css/common.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/devopx/thirdparty/system/css/bootstrap.css}"/>
</head>

<body>
<div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header">
    <!--导航栏-->
    <div th:replace="common/common_body :: body_top"></div>
    <div class="app-main">
        <!--菜单栏-->
        <div th:replace="common/common_body :: body_left"></div>
        <!--右侧主内容-->
        <div class="app-main__outer" style="overflow:auto">
            <div class="app-main__inner">
                <div class="app-page-title">
                    <div class="page-title-wrapper">
                        <div class="page-title-heading">
                            <div class="page-title-icon">
                                <i class="pe-7s-note2 icon-gradient bg-sunny-morning">
                                </i>
                            </div>
                            <div>jenkins部署
                                <div class="page-title-subheading">
                                    jenkins触发后台配置
                                </div>
                            </div>
                        </div>
                        <div class="page-title-actions">
                            <div class="d-inline-block dropdown">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="main-card mb-3 card">
                        <div class="card-body">
                            <div class="form-row">
                                <div class="col-md-4">
                                    <div class="position-relative form-group">
                                        <input name="" id="source_add" class="form-control" style="width: 251px;display:inline">
                                        <button  onclick="sourceAdd()" type="button" class="btn btn-info">添加</button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="position-relative form-group">
                                        <input name="" id="jenkins_flavor_add" class="form-control" style="width: 251px;display:inline">
                                        <button onclick="jenkinsFlavorAdd()" type="button" class="btn btn-info">添加</button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="position-relative form-group">
                                        <input name="" id="jenkins_version_add" class="form-control" style="width: 251px;display:inline">
                                        <button onclick="jenkinsVersionAdd()" type="button" class="btn btn-info">添加</button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col-md-4">
                                <div id="box1">
                                    <table class="mb-0 table table-bordered"  style="table-layout: fixed;">
                                        <thead>
                                        <tr>
                                            <th style="width:10%">SOURCE</th>
                                            <th style="width:10%">操作</th>
                                        </tr>
                                        </thead>
                                        <tbody id="tab_Source">

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                                <div class="col-md-4">
                                    <div id="box2">
                                        <table class="mb-0 table table-bordered"  style="table-layout: fixed;">
                                            <thead>
                                            <tr>
                                                <th style="width:10%">JENKINS_flavor</th>
                                                <th style="width:10%">操作</th>
                                            </tr>
                                            </thead>
                                            <tbody id="tab_JENKINS_flavor">

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div id="box3">
                                        <table class="mb-0 table table-bordered"  style="table-layout: fixed;">
                                            <thead>
                                            <tr>
                                                <th style="width:10%">JENKINS_version</th>
                                                <th style="width:10%">操作</th>
                                            </tr>
                                            </thead>
                                            <tbody id="tab_JENKINS_version">

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<div th:replace="common/common_sources :: base_js"></div>
<div th:replace="common/common_sources :: jebox"></div>
<div th:replace="common/common_sources :: bootstrapPaginator"></div>
<script>
    $(document).ready(function () {
        //选中菜单栏
        ipsSystem.menu.active("DEVOPX_Menu", "JENKINSTRIGGER_Menu");
        init();
        scroll("tab","box1",1);
        scroll("tab","box2",1);
        scroll("tab","box3",1);
    });

    //初始化页面列表
    function init() {
        $.ajax({
            url: "queryAllJenkinsTriggerInfo",
            type: "post",    //不区分大小写
            traditional: true,
            data: {},
            datatype: 'json',
            success: function (result) {
                if (result.code == "success") {
                    //组装页面列表
                     fillingSource(result.data.resultMapSource);
                     fillingJenkinsFlavor(result.data.resultMapJenkinsFlavor);
                     fillingJenkinsVersion(result.data.resultMapJenkinsVersion);
                } else {
                    jeBox.msg('初始化页面失败', {icon: 3, time: 2, maskLock: true, maskClose: true});
                }
            },
            error: function (err) {
                jeBox.msg('初始化页面错误', {icon: 3, time: 2, maskLock: true, maskClose: true});
                console.log(err);
            }
        });
    }
    
    function sourceAdd() {
        var param=$("#source_add").val();
        $.ajax({
            url: "addJenkinsTrigger",
            type: "post",    //不区分大小写
            traditional: true,
            data: {"source": param},
            datatype: 'json',
            success: function (result) {
                if (result.code == "success") {
                    jeBox.msg('新增source成功', {icon: 2, time: 2, maskLock: true, maskClose: true});
                    $("#source_add").val("");
                } else {
                    jeBox.msg(result.data, {icon: 3, time: 2, maskLock: true, maskClose: true});
                }
            },
            error: function (err) {
                jeBox.msg('新增source系统错误', {icon: 3, time: 2, maskLock: true, maskClose: true});
                console.log(err);
            }
        });
    }

    function jenkinsFlavorAdd() {
        var param=$("#jenkins_flavor_add").val();
        $.ajax({
            url: "addJenkinsTrigger",
            type: "post",    //不区分大小写
            traditional: true,
            data: {"jenkinsFlavor": param},
            datatype: 'json',
            success: function (result) {
                if (result.code == "success") {
                    jeBox.msg('新增jenkinsFlavor成功', {icon: 2, time: 2, maskLock: true, maskClose: true});
                    $("#jenkins_flavor_add").val("");
                } else {
                    jeBox.msg(result.data, {icon: 3, time: 2, maskLock: true, maskClose: true});
                }
            },
            error: function (err) {
                jeBox.msg('新增jenkinsFlavor系统错误', {icon: 3, time: 2, maskLock: true, maskClose: true});
                console.log(err);
            }
        });
    }

    function jenkinsVersionAdd() {
        var param=$("#jenkins_version_add").val();
        $.ajax({
            url: "addJenkinsTrigger",
            type: "post",    //不区分大小写
            traditional: true,
            data: {"jenkinsVersion": param},
            datatype: 'json',
            success: function (result) {
                if (result.code == "success") {
                    jeBox.msg('新增jenkinsVersion成功', {icon: 2, time: 2, maskLock: true, maskClose: true});
                    $("#jenkins_version_add").val("");
                } else {
                    jeBox.msg(result.data, {icon: 3, time: 2, maskLock: true, maskClose: true});
                }
            },
            error: function (err) {
                jeBox.msg('新增jenkinsVersion系统错误', {icon: 3, time: 2, maskLock: true, maskClose: true});
                console.log(err);
            }
        });
    }

    //根据后台查询的数据填充table
    function fillingSource(map) {
        if(map.code!="success"){
            return;
        }
        //console.log("dataJson>>" + JSON.stringify(map.data));
        var strHtml="";
        for(var i=0;i<map.data.length;i++){
            strHtml+="<tr>";
            strHtml+="<td>"+map.data[i].source+"</td><td><button onclick='delJenkinsTrigger("+map.data[i].id+")' class='btn btn-danger'>删除</button></td>";
            strHtml+="</tr>";
        }
        $("#tab_Source").empty();
        $("#tab_Source").append(strHtml);
    }

    //根据后台查询的数据填充table
    function fillingJenkinsFlavor(map) {
        if(map.code!="success"){
            return;
        }
        var strHtml="";
        for(var i=0;i<map.data.length;i++){
            strHtml+="<tr>";
            strHtml+="<td>"+map.data[i].jenkinsFlavor+"</td><td><button onclick='delJenkinsTrigger("+map.data[i].id+")' class='btn btn-danger'>删除</button></td>";
            strHtml+="</tr>";
        }
        $("#tab_JENKINS_flavor").empty();
        $("#tab_JENKINS_flavor").append(strHtml);

    }

    //根据后台查询的数据填充table
    function fillingJenkinsVersion(map) {
        if(map.code!="success"){
            return;
        }
        var strHtml="";
        for(var i=0;i<map.data.length;i++){
            strHtml+="<tr>";
            strHtml+="<td>"+map.data[i].jenkinsVersion+"</td><td><button onclick='delJenkinsTrigger("+map.data[i].id+")' class='btn btn-danger'>删除</button></td>";
            strHtml+="</tr>";
        }
        $("#tab_JENKINS_version").empty();
        $("#tab_JENKINS_version").append(strHtml);

    }

    function delJenkinsTrigger(id) {
        alert(id)
    }


</script>
<style>
    #box1 {
        min-height: 360px;
        max-height: 360px;
        max-width: 1500px;
        overflow-y: auto;
        overflow-x: auto;
        position: relative;
    }
    #box2 {
        min-height: 360px;
        max-height: 360px;
        max-width: 1500px;
        overflow-y: auto;
        overflow-x: auto;
        position: relative;
    }
    #box3 {
        min-height: 360px;
        max-height: 360px;
        max-width: 1500px;
        overflow-y: auto;
        overflow-x: auto;
        position: relative;
    }
</style>
</body>
</html>
